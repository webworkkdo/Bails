# Vulnerability Report for @yumenative/baileys

This report details five potential security vulnerabilities identified in the `@yumenative/baileys` codebase. The vulnerabilities primarily focus on Denial of Service (DoS) attacks that could negatively impact a message recipient.

## 1. Uncontrolled Resource Consumption in List Parsing

*   **File:** `lib/WABinary/decode.js`
*   **Function:** `decodeDecompressedBinaryNode`
*   **Vulnerability:** The `readList` function reads a list size from incoming binary data and iterates that many times to decode list items. There is no size validation, allowing a malicious actor to craft a message with an excessively large list size.
*   **Impact:** This can lead to a DoS attack by causing the recipient's device to consume excessive memory and CPU, leading to unresponsiveness or a crash.
*   **Reproduction:**
    1.  Craft a binary message with a `LIST_8` or `LIST_16` tag.
    2.  Set the list size to a very large number (e.g., `0xFF` for `LIST_8` or `0xFFFF` for `LIST_16`).
    3.  Send the message to a user.
*   **Exploitation:** An attacker could repeatedly send these crafted messages, making the recipient's device unusable.

## 2. Uncontrolled Resource Consumption in Call Handling

*   **File:** `lib/Socket/messages-recv.js`
*   **Function:** `handleCall`
*   **Vulnerability:** The `handleCall` function processes and stores incoming call offers in a `callOfferCache` with no limit on its size.
*   **Impact:** An attacker could send a high volume of call offers, exhausting the recipient's memory and leading to a DoS.
*   **Reproduction:**
    1.  Send a large number of call offer notifications to a user in a short period.
*   **Exploitation:** A script could be used to continuously send call offers, causing the target's device to run out of memory and crash.

## 3. Resource Depletion via "Unavailable" Messages

*   **File:** `lib/Socket/messages-recv.js`
*   **Function:** `handleMessage`
*   **Vulnerability:** Receiving an "unavailable" message triggers `requestPlaceholderResend`, which forces the sender's phone to resend the message.
*   **Impact:** An attacker could spam a user with "unavailable" messages, forcing the recipient's phone to repeatedly resend messages, leading to significant battery drain and data consumption.
*   **Reproduction:**
    1.  Send a large number of "unavailable" messages to a user.
*   **Exploitation:** This could be used to drain a target's battery or incur high data charges.

## 4. Potential Vulnerabilities in Message Decryption

*   **File:** `lib/Socket/messages-recv.js`
*   **Function:** `handleMessage`
*   **Vulnerability:** The `decryptMessageNode` function relies on a custom fork of the `libsignal-node` library. Custom forks may not be up-to-date with security patches from the original library.
*   **Impact:** If the forked library contains vulnerabilities, an attacker could craft a malicious message that crashes the client or leads to arbitrary code execution upon decryption.
*   **Reproduction:** This would require a detailed security analysis of the forked `libsignal-node` library.
*   **Exploitation:** A sophisticated attacker could exploit a vulnerability in the decryption library to compromise the user's device.

## 5. Client-Side DoS via Long Group Subject

*   **File:** `lib/Socket/messages-recv.js`
*   **Function:** `handleGroupNotification`
*   **Vulnerability:** The `handleGroupNotification` function does not validate the length of a group subject when processing a group creation notification.
*   **Impact:** An attacker could create a group with an extremely long subject line, which could crash the recipient's WhatsApp client when it tries to render the subject.
*   **Reproduction:**
    1.  Create a WhatsApp group with a very long subject (e.g., thousands of characters).
    2.  Add the target user to the group.
*   **Exploitation:** This can be used to repeatedly crash a user's WhatsApp client.
